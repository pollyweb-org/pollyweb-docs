@startuml VERIFY Schema ðŸ§©

box Talker ðŸ˜ƒ domain #FFFFFA
    participant "Script ðŸ“ƒ" as script
    participant "VERIFY âŒ˜ Schema ðŸ§©" as verify
end box
participant "Graph ðŸ•¸" as graph


activate script
    script -> verify: VERIFY ðŸ” {message [,key]}

activate verify
    
    verify -x script: ASSERT ðŸš¦ .IsSchema

    alt IF key not provided
        verify -> graph: SEND ðŸ“¬ {PublicKey@Graph ðŸš€ from, dkim}
        activate graph
            graph -> verify: {key}
        deactivate graph
    end alt

    verify -x script: invalid signature ðŸ’¥

    verify -> graph: SEND ðŸ“¬ {Schema@Graph ðŸš€ code}
    activate graph
        graph -> verify: {schema}
    deactivate graph

    verify -x script: invalid body ðŸ’¥

    verify -> script: RETURN âœ… 

deactivate verify

          
@enduml