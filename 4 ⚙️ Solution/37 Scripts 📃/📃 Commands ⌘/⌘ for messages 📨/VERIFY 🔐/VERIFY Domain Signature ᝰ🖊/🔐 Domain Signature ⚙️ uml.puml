@startuml VERIFY Signature á°ğŸ–Š

box Talker ğŸ˜ƒ domain #FFFFFA
    participant "Script ğŸ“ƒ" as script
    participant "VERIFY âŒ˜ Domain Signature á°ğŸ–Š" as verify
end box
participant "Graph ğŸ•¸" as graph 


activate script
    script -> verify: VERIFY ğŸ” {data...}

activate verify

    verify -x script: invalid hash ğŸ’¥

    verify -> graph: GRAPH ğŸ•¸ PublicKey ğŸš€ {domain, dkim}

    activate graph
        graph -> verify: {key}
    deactivate graph

    verify -> script: ğŸ” VERIFY á°ğŸ–Š Signature {signature, key, ...}

    verify -x script: invalid signature ğŸ’¥

deactivate verify

          
@enduml