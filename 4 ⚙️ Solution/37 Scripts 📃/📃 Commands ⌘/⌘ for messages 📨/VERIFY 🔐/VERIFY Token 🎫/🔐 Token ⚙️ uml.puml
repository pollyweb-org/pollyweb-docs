@startuml VERIFY Token ðŸŽ«

box Talker ðŸ˜ƒ domain #FFFFFA
    participant "Script ðŸ“ƒ" as script
    participant "VERIFY ðŸ” Token ðŸŽ«" as verify
end box
participant "Graph ðŸ•¸" as graph 
participant "Broker ðŸ¤µ" as broker


activate script
    script -> verify: VERIFY ðŸ” {token}

activate verify
    
    verify -x script: invalid hash ðŸ’¥
    verify -x script: token not started or expired ðŸ’¥

    verify -> graph: TRUSTS ðŸ«¡ {issuer, schema}
    verify -x script: untrusted issuer ðŸ’¥ 

    verify -> graph: VERIFY ðŸ” Domain ðŸ‘¥
    verify -x script: invalid signature ðŸ’¥ 

    verify -> graph: VERIFY ðŸ” Schema ðŸ§©
    verify -x script: invalid schema ðŸ’¥

    verify -> broker: SEND ðŸ“¬ Status@Broker ðŸš€ {token, issuer}
    verify -x script: token not active ðŸ’¥
    
    verify -> script: RETURN âœ… 

deactivate verify

          
@enduml