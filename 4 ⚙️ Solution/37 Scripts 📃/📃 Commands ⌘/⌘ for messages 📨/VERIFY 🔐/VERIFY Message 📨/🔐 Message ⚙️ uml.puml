@startuml VERIFY Domain Message ðŸ“¨

box Talker ðŸ˜ƒ domain #FFFFFA
    participant "Script ðŸ“ƒ" as script
    participant "VERIFY âŒ˜ Message ðŸ“¨" as verify
end box
participant "Graph ðŸ•¸" as graph


activate script
    script -> verify: VERIFY ðŸ” {message [,key]}

activate verify
    
    verify -x script: invalid hash ðŸ’¥

    alt IF key is not empty
        verify -x script: VERIFY ðŸ” Signature á°ðŸ–Š
    else IF key is empty
        verify -> graph: VERIFY ðŸ” Domain ðŸ‘¥
        verify -x script: invalid signature ðŸ’¥
    end alt

    verify -> script: RETURN âœ… 

deactivate verify

          
@enduml