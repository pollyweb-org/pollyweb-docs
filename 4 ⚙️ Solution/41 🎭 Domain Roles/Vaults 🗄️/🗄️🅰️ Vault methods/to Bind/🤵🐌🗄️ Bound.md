<!-- 
ğŸ—„ï¸ğŸŒ https://quip.com/oSzpA7HRICjq/-Broker-Binds#temp:C:DSD3f7309f961e24f0ebb5897e2f 
ğŸ—„ï¸ğŸŒ https://quip.com/IZapAfPZPnOD#temp:C:PDZf81764583b31439f999550159  
-->


# ğŸ¤µğŸŒğŸ—„ï¸ Bound @Â Vault

* Used by
  * [ğŸ—„ï¸â©ğŸ§‘â€ğŸ¦° Bind @ Vault](<../../../../20 ğŸ§‘â€ğŸ¦° UI/Wallets ğŸ§‘â€ğŸ¦°/ğŸ§‘â€ğŸ¦°ğŸ’¬ Wallet in Prompts ğŸ¤”/ğŸ‘‰ğŸ—„ï¸ Bind ğŸ”—.md>) flow
  * [ğŸ¤µâ©ğŸ—„ï¸ Bind vault @Â Broker](<../../../../20 ğŸ§‘â€ğŸ¦° UI/Brokers ğŸ¤µ/ğŸ¤µâ© Broker flows/ğŸ¤µâ©ğŸ—„ï¸ Bind vault.md>) flow

<br/>

## Async Message ğŸŒ


```yaml
Header:
    From: any-broker.dom
    To: any-vault.dom
    Subject: Bound@Vault

Body:
    Callback: <callback-uuid>
    Binds:
      - ID: <bind-uuid>
        Code: europa.eu/DISABILITY/CARD
```

|Object|Property|Type|Description
|-|-|-|-
|Header| `From` | string | [Broker ğŸ¤µ](<../../../../20 ğŸ§‘â€ğŸ¦° UI/Brokers ğŸ¤µ/ğŸ¤µğŸ¤² Broker helper.md>) from [`Bindable@Broker`](<../../../../20 ğŸ§‘â€ğŸ¦° UI/Brokers ğŸ¤µ/ğŸ¤µğŸ…°ï¸ Broker methods/4 ğŸ¤µğŸ…°ï¸ Binds ğŸ”—/ğŸ—„ï¸ğŸŒğŸ¤µ Bindable.md>)
|| `To` | string | [Vault ğŸ—„ï¸](<../../ğŸ—„ï¸ğŸ­ Vault role.md>)  from [`Bindable@Broker`](<../../../../20 ğŸ§‘â€ğŸ¦° UI/Brokers ğŸ¤µ/ğŸ¤µğŸ…°ï¸ Broker methods/4 ğŸ¤µğŸ…°ï¸ Binds ğŸ”—/ğŸ—„ï¸ğŸŒğŸ¤µ Bindable.md>)
|| `Subject` | string | `Bound@Vault`
|Body| `Callback` | uuid | Callback from [`Bindable@Broker`](<../../../../20 ğŸ§‘â€ğŸ¦° UI/Brokers ğŸ¤µ/ğŸ¤µğŸ…°ï¸ Broker methods/4 ğŸ¤µğŸ…°ï¸ Binds ğŸ”—/ğŸ—„ï¸ğŸŒğŸ¤µ Bindable.md>)
||`Binds`| array | list of Bind objects
|Bind| `ID`| uuid | [Bind ğŸ”— ID](<../../../../30 ğŸ§© Data/Binds ğŸ”—/ğŸ”— Bind.md>) on the [Broker ğŸ¤µ](<../../../../20 ğŸ§‘â€ğŸ¦° UI/Brokers ğŸ¤µ/ğŸ¤µğŸ¤² Broker helper.md>)
|| `Code`| string | [Code ğŸ§©](<../../../../30 ğŸ§© Data/Codes ğŸ§©/ğŸ§© Schema Code.md>)  from [`Bindable@Broker`](<../../../../20 ğŸ§‘â€ğŸ¦° UI/Brokers ğŸ¤µ/ğŸ¤µğŸ…°ï¸ Broker methods/4 ğŸ¤µğŸ…°ï¸ Binds ğŸ”—/ğŸ—„ï¸ğŸŒğŸ¤µ Bindable.md>)
|

<br/>

## Handler

```yaml
# Resolve the callback
- MAP|Callbacks|$Msg.Callback >> $callback

# Process each Bind
- PARALLEL|$Msg.Binds >> $bind:

    # Save each bind
    - UPSERT|Binds:
        Broker: $Msg.From
        BindID: $bind.ID
        Code: $bind.Code
        Reference: $callback.Reference

- CALLBACK|$callback
```

| [Command âŒ˜](<../../../../35 ğŸ’¬ Chats/ğŸ˜ƒ Talkers/ğŸ˜ƒâš™ï¸ Talker cmds/for control/âŒ˜ Command.md>) | Purpose
|-|-
| [`$.Msg`](<$.Msg holder.md>)
| ğŸ—ºï¸ [`MAP`](<../../../../35 ğŸ’¬ Chats/ğŸ˜ƒ Talkers/ğŸ˜ƒâš™ï¸ Talker cmds/for data/MAP ğŸ—ºï¸ item.md>) | Get the [Callback ğŸª£](<../../ğŸ—„ï¸ğŸª£ Vault tables/ğŸ—„ï¸ğŸª£ Callbacks.md>) from [`Bindable@Broker`](<../../../../20 ğŸ§‘â€ğŸ¦° UI/Brokers ğŸ¤µ/ğŸ¤µğŸ…°ï¸ Broker methods/4 ğŸ¤µğŸ…°ï¸ Binds ğŸ”—/ğŸ—„ï¸ğŸŒğŸ¤µ Bindable.md>)  
| ğŸ›¢ [`UPSERT`](<../../../../35 ğŸ’¬ Chats/ğŸ˜ƒ Talkers/ğŸ˜ƒâš™ï¸ Talker cmds/for data/UPSERT ğŸ›¢ item.md>) | Save the [Bind ğŸ”—](<../../../../30 ğŸ§© Data/Binds ğŸ”—/ğŸ”— Bind.md>) to [Binds ğŸª£](<../../ğŸ—„ï¸ğŸª£ Vault tables/ğŸ—„ï¸ğŸª£ Binds.md>)
|


<br/>


## FAQ

1. **Where is the BindID generated?**

    The [Bind ğŸ”—](<../../../../30 ğŸ§© Data/Binds ğŸ”—/ğŸ”— Bind.md>) ID is generated by the [Broker ğŸ¤µ domain](<../../../../20 ğŸ§‘â€ğŸ¦° UI/Brokers ğŸ¤µ/ğŸ¤µğŸ¤² Broker helper.md>) (and not on the [Vault ğŸ—„ï¸ domain](<../../ğŸ—„ï¸ğŸ­ Vault role.md>)).
    
    * This is to ensure that the [Broker ğŸ¤µ domain](<../../../../20 ğŸ§‘â€ğŸ¦° UI/Brokers ğŸ¤µ/ğŸ¤µğŸ¤² Broker helper.md>) has always the most updated list of [Binds ğŸ”—](<../../../../30 ğŸ§© Data/Binds ğŸ”—/ğŸ”— Bind.md>) to share with the [Wallet ğŸ§‘â€ğŸ¦° app](<../../../../20 ğŸ§‘â€ğŸ¦° UI/Wallets ğŸ§‘â€ğŸ¦°/ğŸ§‘â€ğŸ¦°ğŸ› ï¸ Wallet app.md>), even if the [Vault ğŸ—„ï¸ domain](<../../ğŸ—„ï¸ğŸ­ Vault role.md>) has not yet processed that [Bind ğŸ”—](<../../../../30 ğŸ§© Data/Binds ğŸ”—/ğŸ”— Bind.md>).

    ---
    <br/>