@startuml Disclose@Broker

participant "Broker ğŸ¤µ" as broker
box Vault ğŸ—„ï¸ï¸ domain #FFFFFA
    participant "Script ğŸ“ƒ" as vault
    participant "Talker ğŸ˜ƒ" as talker
    participant "Hosted ğŸ“¦" as hosted
end box
'participant "Consumer ğŸ’¼" as consumer


broker --> vault: Disclose ğŸŒ

activate vault    
    vault -> talker: TRUSTS ğŸ«¡ {consumer}
    vault -> talker: ASYNC ğŸ‘·ğŸ¼ {disclose}

activate talker
    talker --> hosted: Handle ğŸŒ {hook, disclose}
activate hosted
    talker -> vault: {hook}
deactivate talker
    vault --> vault: WAIT ğŸ§˜ {hook}
deactivate vault

    hosted --> talker: Handled ğŸŒ {hook, data}
deactivate hosted

activate talker
    talker --> vault: REEL ğŸ£ {hook}
deactivate talker

activate vault
    vault -> vault: SAVE ğŸ’¾ {READY, data}
    'vault --> consumer: Consume ğŸŒ {data}
deactivate vault

@enduml 