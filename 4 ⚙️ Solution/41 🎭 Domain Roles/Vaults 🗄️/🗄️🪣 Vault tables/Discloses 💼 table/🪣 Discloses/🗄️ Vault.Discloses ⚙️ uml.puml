@startuml Vault.Discloses

participant "Broker ğŸ¤µ" as broker

box Vault ğŸ—„ï¸ domain #FFFFFA
    participant "Discloses ğŸª£" as table
    participant "Schemas ğŸª£" as schemas
    participant "Script ğŸ“ƒ" as handler
end box
participant "Graph ğŸ•¸" as graph
participant "Consumer ğŸ’¼" as consumer


broker --> table: ğŸŒ Disclose @ Vault 

activate table
    table -> graph: ğŸ”” ASKED: ğŸš€ Trusts @ Graph âŒ UNTRUSTED
    table -> consumer: ğŸ”” TRUSTED: ğŸš€ Queried @ Consumer 
    table -> schemas: ğŸ”” DETAILED: READ ğŸ§² 
    
    activate table
        table -> handler: ğŸƒ RUN {script, context}
    deactivate table
    activate handler
        handler -> table: SAVE ğŸ’¾ {data}
    deactivate handler

    table --> consumer: ğŸ”” READY: ğŸŒ Consume @ Consumer
deactivate table

activate consumer
    consumer -> table: ğŸš€ Collect @ Vault
deactivate consumer


@enduml 