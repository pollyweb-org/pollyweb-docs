@startuml OnDiscloseAsked

box Vault ğŸ—„ï¸ domain #FFFFFA
    participant "Discloses ğŸª£" as table
    participant "OnAsked ğŸ””" as handler
end box
participant "Graph ğŸ•¸" as graph


activate table
    table --> handler: ASKED ğŸ”” 
deactivate table

activate handler
    handler -> graph: TRUSTS ğŸ«¡ {consumer}
    
    alt trusted?
        handler -> table: SAVE ğŸ’¾ {TRUSTED}
    else
        handler -> table: SAVE ğŸ’¾ {UNTRUSTED}
    end alt
deactivate handler

@enduml 