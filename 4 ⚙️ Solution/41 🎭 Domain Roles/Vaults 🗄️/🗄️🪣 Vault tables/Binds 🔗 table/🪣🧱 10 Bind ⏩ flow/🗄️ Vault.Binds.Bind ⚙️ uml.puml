@startuml Vault.Binds

box Vault ðŸ—„ï¸ domain #FFFFFA
    participant "Script  ðŸ“ƒ" as script
    participant "BIND âŒ˜" as cmd
    participant "Binds ðŸª£" as binds
    participant "Hosted ðŸ“¦" as hosted
end box
participant "Broker ðŸ¤µ" as broker


activate script
    script -> cmd: BIND âŒ˜ {schema, ref}
deactivate script

activate cmd
    cmd -> binds: ðŸ’¾ {OFFERED}
deactivate cmd

activate binds
    binds -> broker: ðŸŒ Bind @ Broker 
deactivate binds

activate broker
    broker -> binds: IF "no": ðŸŒ Bound @ Vault ðŸ’¾ {DECLINED}
activate binds
    broker -> binds: IF "yes": ðŸŒ Bound @ Vault ðŸ’¾ {BOUND}
deactivate broker

    group IF {BOUND, ref}
        binds -> hosted: ASYNC ðŸ‘·ðŸ¼ {Bound, ref}
    end group

    binds -> cmd: REEL ðŸŽ£ {result}

deactivate binds

activate cmd
    cmd -> script: RETURN {result}
deactivate cmd

@enduml 