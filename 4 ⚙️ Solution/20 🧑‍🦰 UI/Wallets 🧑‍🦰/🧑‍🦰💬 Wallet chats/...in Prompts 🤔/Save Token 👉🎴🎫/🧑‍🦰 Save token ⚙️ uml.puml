@startuml Accept()


' ----------------------
'actor "User" as user
'participant "Notifier üì£" as notifier
''participant "Graph üï∏" as graph
participant "Issuer üé¥" as issuer
participant "Broker ü§µ" as broker
participant "Wallet üë±" as wallet


activate issuer
    issuer --> wallet: 1) Prompt ‚è© {issuing your token...}
''deactivate issuer

''activate wallet
''    user --> wallet: transact
''    wallet --> issuer: 
''deactivate wallet

''activate issuer
    issuer --> broker: 2) Issue üêå 
deactivate issuer

activate broker
''    broker -> graph : 3) Translate üöÄ {code}
''    
''    activate graph
''        graph --> broker: {translation}
''    deactivate graph

    broker -> wallet: 3) Prompt ‚è© {save?}
''deactivate broker

''activate wallet 
''    user --> wallet: yes
''    wallet --> broker: 
''deactivate wallet

''group If user accepted


''activate broker
    broker --> wallet: 4) Save üêå 
deactivate broker

' NOTIFY
''activate notifier
''    notifier --> wallet
''deactivate notifier

' ACCEPT
activate wallet
    ' DOWNLOAD
    wallet -> issuer: 5) Issued üöÄ {token}
    ''activate issuer
    ''    issuer -> wallet: {token}
    ''deactivate issuer
    ''wallet -> wallet: save

    ' CONFIRM
    wallet --> broker: 6) Saved üêå {path}
deactivate wallet

activate broker
''end group

    broker --> issuer: 7) Offered üêå
deactivate broker

activate issuer
    issuer --> wallet: 8) Prompt ‚è© {saved to your wallet}
deactivate issuer


' ----------------------
@enduml