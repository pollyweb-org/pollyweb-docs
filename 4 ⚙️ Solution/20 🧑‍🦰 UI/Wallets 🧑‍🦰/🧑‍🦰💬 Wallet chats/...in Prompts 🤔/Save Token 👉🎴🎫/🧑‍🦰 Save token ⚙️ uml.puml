@startuml Accept()


' ----------------------
actor "User" as user
participant "Wallet ğŸ‘±" as wallet
participant "Notifier ğŸ“£" as notifier
participant "Broker ğŸ¤µ" as broker
participant "Graph ğŸ•¸" as graph
participant "Issuer ğŸ´" as issuer


activate issuer
    issuer --> wallet: 1) âª Prompt ğŸ¤” {transact?}
deactivate issuer

activate wallet
    user --> wallet: transact
    wallet --> issuer: 
deactivate wallet

activate issuer
    issuer --> broker: 2) Offer ğŸŒ {hook}
deactivate issuer

activate broker
    broker -> graph : 3) Translate ğŸš€ {code}
    
    activate graph
        graph --> broker: {translation}
    deactivate graph

    broker --> wallet: 4) âª Prompt ğŸ¤” {save?}
deactivate broker

activate wallet 
    user --> wallet: yes
    wallet --> broker: 
deactivate wallet

group If user accepted


activate broker
    broker --> notifier: 5) Save ğŸŒ {token}
deactivate broker

' NOTIFY
activate notifier
    notifier --> wallet
deactivate notifier

' ACCEPT
activate wallet
    ' DOWNLOAD
    wallet -> issuer: 6) Issued ğŸš€
    activate issuer
        issuer -> wallet: {token}
    deactivate issuer
    wallet -> wallet: save

    ' CONFIRM
    wallet --> broker: 7) Saved ğŸŒ { token, path }
deactivate wallet

activate broker
end group

    broker --> issuer: 8) Accepted {hook, token} ğŸŒ
deactivate broker

activate issuer
    issuer --> wallet: 9) âª Prompt ğŸ¤”
deactivate issuer


' ----------------------
@enduml