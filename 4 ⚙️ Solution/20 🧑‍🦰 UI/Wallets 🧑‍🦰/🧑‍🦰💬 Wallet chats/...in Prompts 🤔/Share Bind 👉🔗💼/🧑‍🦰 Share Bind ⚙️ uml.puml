@startuml Wallet: Share()

participant "Wallet ğŸ‘±" as user
participant "Broker ğŸ¤µ" as broker
participant "Consumer ğŸ’¼" as consumer
participant "Vault ğŸ—„ï¸" as vault
participant "Graph ğŸ•¸" as graph

' --------------------
' QUERY
' --------------------

activate consumer

group Request the data

    consumer --> broker: 1) Query  ğŸŒ
    deactivate consumer

    ' Broker ğŸ¤µ
    activate broker 
    broker -> graph: 2) Queryable ğŸš€ {codes}
    broker -> graph: 3) Translate ğŸš€ {codes}

    alt Select if 2+ vaults
        broker --> user: 4 âª Prompt ğŸ¤”
        deactivate broker

        activate user
            user --> broker: {selected}
        deactivate user

        activate broker
    end alt

    broker --> vault: 5) Disclose ğŸŒ {code}
    deactivate broker

    activate vault

end group

group Gather the data

    alt If requires context
        ' Get te context.
        vault -> consumer: 6) Queried ğŸš€ 
        activate consumer
        consumer --> vault: {context}
        deactivate consumer
    end alt

    ' Ask user to confirm.
    vault --> user: 7 âª Prompt ğŸ¤” {confirm?}
end group

vault --> consumer: 8 âª Consume ğŸ§©
deactivate vault 



@enduml 