@startuml Broker.Queries

participant "Consumer ğŸ’¼" as consumer
box Broker ğŸ¤µ domain #FFFFFA
    participant "Query ğŸŒ" as script
    participant "Queries ğŸª£" as queries
    participant "Forms ğŸª£" as forms
    participant "Wallets ğŸª£" as wallets
end box
participant "Graph ğŸ•¸" as graph
participant "Wallet ğŸ‘±" as wallet
participant "Vault ğŸ—„ï¸" as vault

consumer -> script: Query ğŸŒ

activate script
    script -> queries: SAVE ğŸ’¾
deactivate script

activate queries
    queries -> forms: ğŸ”” QUERIED: informed? âŒ ABRUPT 
    queries -> wallets: ğŸ”” INFORMED: READ ğŸ§² {Binds, Tokens} âŒ UNMATCHED 
    queries -> graph: ğŸ”” MATCHED: TRUSTS ğŸ«¡ {consumer} âŒ UNTRUSTED 
    queries -> wallet: ğŸ”” TRUSTED: ONE ğŸ¤” "Select" âŒ UNSELECTED 
    queries -> wallet: ğŸ”” SELECTED: CONFIRM ğŸ‘ "Share?" âŒ REJECTED 
    group ğŸ”” One of: DISCLOSED, SHARED 
    queries -> wallet: ğŸ”” SHARED: Share @ Notifier ğŸŒ
    queries -> vault: ğŸ”” DISCLOSED: Disclose @ Vault ğŸŒ
    end group 
deactivate queries


@enduml