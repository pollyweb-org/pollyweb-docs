@startuml Broker.Queries

participant "Consumer ğŸ’¼" as consumer
box Broker ğŸ¤µ domain #FFFFFA
    participant "Query ğŸŒ" as script
    participant "Queries ğŸª£" as queries
    participant "Forms ğŸª£" as forms
    participant "Wallets ğŸª£" as wallets
end box
participant "Graph ğŸ•¸" as graph
participant "Wallet ğŸ‘±" as wallet
participant "Vault ğŸ—„ï¸" as vault

consumer -> script: Query ğŸŒ

activate script
    script -> queries: ğŸ’¾ QUERIED
deactivate script

activate queries
    queries -> forms: informed?
deactivate queries

activate forms
    forms -> queries: ğŸ’¾ INFORMED âœ… ABRUPT âŒ
deactivate forms

activate queries
    queries -> wallets: READ ğŸ§² {Binds, Tokens}
deactivate queries

activate wallets
    'wallets -x consumer: ğŸ’¾ EMPTY ğŸŒ Suggest @ Consumer 
    wallets -> queries: ğŸ’¾ DETAILED âœ… EMPTY âŒ
deactivate wallets

activate queries
    queries -> graph: Trusts @ Graph ğŸš€
deactivate queries

activate graph
    'graph -x consumer: ğŸ’¾ EMPTY ğŸŒ Suggest @ Consumer 
    graph -> queries: ğŸ’¾ TRUSTED âœ… EMPTY âŒ
deactivate graph

activate queries
    queries -> wallet: ONE "Select"
    queries -> wallet: CONFIRM ğŸ‘ "Share?"
deactivate queries

activate wallet
    wallet -> queries: ğŸ’¾ DISCLOSED or SHARED âœ… REJECTED âŒ
deactivate wallet

activate queries
    queries -> wallet: âœ… SHARED: Share @ Notifier ğŸŒ
    queries -> vault: âœ… DISCLOSED: Disclose @ Vault ğŸŒ
deactivate queries


@enduml