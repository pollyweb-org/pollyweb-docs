@startuml OnQueryTrusted

box Broker ğŸ¤µ domain #FFFFFA
    participant "Queries ğŸª£" as table
    participant "OnTrusted ğŸ””" as handler
    participant "Schemas ğŸª£" as schemas
end box
participant "Wallet ğŸ‘±" as wallet


activate table
    table --> handler: TRUSTED ğŸ””
deactivate table

activate handler

    group If many
        handler -> wallet: ONE "Which one?" 
    end group

    handler -> schemas: READ ğŸ§²
    handler -> wallet: CONFIRM ğŸ‘ "share?"

    alt IF Bind
        handler -> table: SAVE ğŸ’¾ {DISCLOSED} 
    else IF Token
        handler -> table: SAVE ğŸ’¾ {SHARED}
    end

deactivate handler

@enduml