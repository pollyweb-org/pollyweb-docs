@startuml OnTokenDeclined

participant "Issuer ğŸ´" as issuer

box Broker ğŸ¤µ domain #FFFFFA
    participant "Offer@ ğŸ“ƒ" as script
    participant "Tokens ğŸª£" as tokens
    participant "OnDeclined ğŸ””" as change
end box

participant "Wallet ğŸ‘±" as wallet
'participant "Notifier ğŸ“£" as notifier

' The issuer offers a token to the broker
issuer --> script: Offer ğŸŒ

activate script
    ' The Broker asks the wallet if it wants to save the token
    script --> wallet: CONFIRM ğŸ‘ {save?}   
deactivate script

activate wallet
    ' The wallet rejects the token
    wallet --> script: {no}
deactivate wallet

activate script
    script -> tokens: SAVE ğŸ’¾ {REJECTED}
deactivate script

activate tokens
    tokens --> change: REJECTED ğŸ””
deactivate tokens

activate change
    change --> issuer: SEND ğŸ“¬ {Declined ğŸŒ}
deactivate change

@enduml 