@startuml OnTokenOffered

participant "Issuer ğŸ´" as issuer
box Broker ğŸ¤µ domain #FFFFFA
    participant "Offer ğŸŒ" as offer
    participant "Tokens ğŸª£" as tokens
    participant "OnOffered ğŸ””" as offered
end box
participant "Wallet ğŸ‘±" as wallet


issuer --> offer: Offer ğŸŒ {token}

activate offer
    offer -> tokens: SAVE ğŸ’¾ {ISSUED}
deactivate offer

activate tokens
    tokens --> offered: OFFERED ğŸ””
deactivate tokens

activate offered
    group IF declined
        offered --> issuer: SEND ğŸ“¬ {Offered ğŸŒ token, accepted:false}    
    end group
    group IF accepted
        offered --> wallet: SEND ğŸ“¬ {Save ğŸŒ token}
deactivate offered
    end group
    

@enduml 