@startuml OnChatterBroker


box Broker ğŸ¤µ domain #FFFFFA
    participant "Chats ğŸª£" as chats
    participant "OnPresented ğŸ””" as script
    participant "Chatters ğŸª£" as table
    participant "OnBroker ğŸ””" as handler
    participant "Talker ğŸ˜ƒ" as talker
end box

participant "Wallet ğŸ‘±" as wallet

chats --> script: PRESENTED ğŸ””

activate script
    script -> table: SAVE ğŸ’¾ {BROKER}
deactivate script

activate table
    table --> handler: BROKER ğŸ””
deactivate table

activate handler
    handler -> talker: CHAT ğŸ’¬
    handler --> wallet: INFO â“˜ {reason}
    handler --> wallet: INFO â“˜ {shared binds}
    handler --> wallet: INFO â“˜ {shared tokens}
    handler -> chats: SAVE ğŸ’¾ {ACTIVE}
deactivate handler

@enduml