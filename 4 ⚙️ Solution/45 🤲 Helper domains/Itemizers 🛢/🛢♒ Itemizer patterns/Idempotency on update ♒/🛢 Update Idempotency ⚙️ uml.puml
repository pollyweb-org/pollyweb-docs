@startuml State machine

box sender ðŸ‘¥ domain #FFFFFA
    participant "Script ðŸ“ƒ" as script
    participant "Dataset ðŸª£ Key: hook" as table
    participant "Inbox ðŸ“¥" as inbox
end box

box receiver ðŸ‘¥ domain #FFFFFA
    participant "Handler ðŸŒ" as handler
end box


activate script
    script -> table: SAVE ðŸ’¾ {hook, STATE-1}
    script --> handler: SEND ðŸ“¬ {hook}
deactivate script

activate handler
    handler --x inbox: Message ðŸŒ {hook, result}
activate inbox
    inbox -> table: READ ðŸ§² {hook} >> item
    inbox -> table: SAVE ðŸ’¾ item {result, STATE-2}

activate table
    table -> inbox: 
deactivate inbox
    <-- table  : Event ðŸ”” {STATE-2}
deactivate table

    handler --> inbox: Message ðŸŒ {hook, result}
deactivate handler

activate inbox
    inbox -> table: READ ðŸ§² {hook} >> item
    inbox -> table: SAVE ðŸ’¾ item {result, STATE-2}
activate table
    table -> inbox: No event raised âœ…
deactivate table
deactivate inbox


@enduml