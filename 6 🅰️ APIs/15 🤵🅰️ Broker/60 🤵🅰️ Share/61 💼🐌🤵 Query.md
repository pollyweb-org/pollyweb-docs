<!-- https://quip.com/rKzMApUS5QIi#temp:C:WTI8724d650e2ae45dabb56baea4 -->

# ğŸ’¼ğŸŒğŸ¤µ  Query @ Broker

> In a [Chat ğŸ’¬](<../../../4 âš™ï¸ Solution/20 ğŸ§‘â€ğŸ¦° UI/23 ğŸ’¬ Chats/01 ğŸ’¬ Chat.md>), a [Consumer ğŸ’¼ domain](<../../../4 âš™ï¸ Solution/20 ğŸ§‘â€ğŸ¦° UI/27 ğŸ’¼ Consumers/04 ğŸ’¼ğŸ­ Consumer role.md>) asks the [Broker ğŸ¤µ domain](<../../../4 âš™ï¸ Solution/20 ğŸ§‘â€ğŸ¦° UI/03 ğŸ¤µ Brokers/03 ğŸ¤µ Broker domain.md>) for access to user data in one or more [Schema Codes ğŸ§©](<../../../4 âš™ï¸ Solution/20 ğŸ§‘â€ğŸ¦° UI/24 ğŸ—„ï¸ Vaults/02 ğŸ§© Schema Code.md>).

> Used by [ğŸ’¼â©ğŸ§‘â€ğŸ¦° Query token](<../../../5 â© Flows/24 ğŸ’¼â© Consumers/03 ğŸ’¼â©ğŸ§‘â€ğŸ¦° Query token.md>).

<br/> 

## Async Message ğŸŒ

```yaml
Header:
    From: any-consumer.com
    To: any-broker.com
    Subject: Query@Broker

Body:
    ChatID: <chat-uuid>
    Codes:
      # either the driver's license,
      - usa.gov/DRIVER-LICENSE:1.0
      # or the passport.
      - icao.int/PASSPORT:1.0 # either the old passport,
      - icao.int/PASSPORT:2.0 # or the new version.
```

|Object|Property|Type|Description
|-|-|-|-
| Header | `From`| sting | [Consumer ğŸ’¼ domain](<../../../4 âš™ï¸ Solution/20 ğŸ§‘â€ğŸ¦° UI/27 ğŸ’¼ Consumers/04 ğŸ’¼ğŸ­ Consumer role.md>) name
| | `To` | string | [Broker ğŸ¤µ domain](<../../../4 âš™ï¸ Solution/20 ğŸ§‘â€ğŸ¦° UI/03 ğŸ¤µ Brokers/03 ğŸ¤µ Broker domain.md>) name
| | `Subject` | string | `Query@Broker`
| Body | `ChatID` | string | [Chat ğŸ’¬](<../../../4 âš™ï¸ Solution/20 ğŸ§‘â€ğŸ¦° UI/23 ğŸ’¬ Chats/01 ğŸ’¬ Chat.md>) ID
| | `Codes` | string[] | List of [Schema Codes ğŸ§©](<../../../4 âš™ï¸ Solution/20 ğŸ§‘â€ğŸ¦° UI/24 ğŸ—„ï¸ Vaults/02 ğŸ§© Schema Code.md>)
|

<br/>

> Although many [Schema Codes ğŸ§©](<../../../4 âš™ï¸ Solution/20 ğŸ§‘â€ğŸ¦° UI/24 ğŸ—„ï¸ Vaults/02 ğŸ§© Schema Code.md>) may be requested,
> <br/>â€¢ only one of them will be returned; 
> <br/>â€¢ this allows for alternative documents;
> <br/>â€¢ e.g., passport or driver's license.

> For [Tokens ğŸ«](<../../../4 âš™ï¸ Solution/20 ğŸ§‘â€ğŸ¦° UI/25 ğŸ« Tokens/01 ğŸ« Token.md>), 
> <br/>â€¢ only shows the ones that are active,
> <br/>â€¢ i.e., within the start and expiration date.

> For the [Schema Codes ğŸ§©](<../../../4 âš™ï¸ Solution/20 ğŸ§‘â€ğŸ¦° UI/24 ğŸ—„ï¸ Vaults/02 ğŸ§© Schema Code.md>) marked with SELF, 
> <br/>â€¢ only shows the [Tokens ğŸ«](<../../../4 âš™ï¸ Solution/20 ğŸ§‘â€ğŸ¦° UI/25 ğŸ« Tokens/01 ğŸ« Token.md>) issued by the [Consumer ğŸ’¼ domain](<../../../4 âš™ï¸ Solution/20 ğŸ§‘â€ğŸ¦° UI/27 ğŸ’¼ Consumers/04 ğŸ’¼ğŸ­ Consumer role.md>),
> <br/>â€¢ e.g., [`nlweb.org/BOOKING/SELF ğŸ§©`](<../../../8 ğŸ“œ Manifests/ğŸ‘¥ nlweb.org/{codes}/HOST/ğŸ§© HostBookingSelf.md>)
