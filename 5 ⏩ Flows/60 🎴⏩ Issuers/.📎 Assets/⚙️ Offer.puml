@startuml Accept()


' ----------------------
actor "User\nin chat" as user
participant "Wallet ğŸ‘±\napp" as wallet
participant "Notifier ğŸ“£\nbff" as notifier
participant "Broker ğŸ¤µ\ndomain" as broker
participant "Issuer ğŸ´\ndomain" as issuer
participant "Graph ğŸ•¸\ndomain" as graph

' ISSUE
activate issuer
    issuer --> broker: 1) Offer ğŸŒ
deactivate issuer

activate broker
    broker -> graph : 2) Translate ğŸš€ {code}
    broker --> wallet: 3) âª Prompt 
deactivate broker

activate wallet
    user --> wallet: save
    wallet --> broker: {Yes}
deactivate wallet

activate broker
    broker --> notifier: 4) Save ğŸŒ
deactivate broker

' NOTIFY
activate notifier
    notifier --> wallet
deactivate notifier

' ACCEPT
activate wallet
    ' DOWNLOAD
    wallet -> issuer: 5) Issued ğŸš€
    activate issuer
        issuer -> wallet: {token}
    deactivate issuer
    wallet -> wallet: save

    ' CONFIRM
    wallet --> broker: 6) Saved ğŸŒ { path }
deactivate wallet

' NOTIFY
activate broker
    broker --> wallet: 7) âª Update tokens 
    broker --> issuer: 8) Accepted ğŸŒ
deactivate broker

activate issuer
    issuer --> wallet: 9) âª Prompt 
deactivate issuer


' ----------------------
@enduml