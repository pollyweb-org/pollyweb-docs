@startuml Wallet: Share()


actor "User\nInterface" as user
participant "Broker ğŸ¤µ\n(domain)" as broker
participant "Consumer ğŸ’¼\n(domain)" as consumer
participant "Vault ğŸ—„ï¸\n(domain)" as vault
participant "Graph ğŸ•¸\n(domain)" as graph

' --------------------
' QUERY
' --------------------

activate consumer

group Request

    consumer --> broker: 1) Query  ğŸŒ
    deactivate consumer

    ' Broker ğŸ¤µ
    activate broker 
    broker -> graph: 2) Queryable ğŸš€ {codes}
    broker -> graph: 3) Translate ğŸš€ {codes}

    alt Select if 2+ vaults
        broker --> user: 4 âª prompt
        deactivate broker

        activate user
            user --> broker: {selected}
        deactivate user

        activate broker
    end alt

    broker --> vault: 5) Disclose ğŸŒ {code}
    deactivate broker

    activate vault
    vault -> graph: 6) Trusts ğŸš€

end group

'group User confirmation

    vault --> user: 7 âª prompt (user confirmation)

'end group 


group Response

        vault --> consumer: 8) Consume ğŸŒ
    deactivate vault

    activate consumer
        consumer -> graph: 9) Trusts ğŸš€ {vault}
        consumer -> vault: 10) Collect ğŸš€
        activate vault
            vault -> consumer: {data}
        deactivate vault

end group

    deactivate consumer

@enduml 